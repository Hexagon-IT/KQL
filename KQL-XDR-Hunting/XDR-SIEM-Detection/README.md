# XDR & SIEM Detection KQL queries
Thank you for visiting @LearningKijo KQL repository.
In this Identity KQL repository, I am delighted to share out-of-the-box ***XDR & SIEM Detection*** KQL queries. 

### Detection & Data Visualization
| Type    | Detection & Data Visualization        |
|:--------|:--------------------------------------|
| XDR     | [01-XDR-DetectionPercentage-SecurityProducts.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-Detection-Query-Repository/01-XDR-DetectionPercentage-SecurityProducts.md) |
| EDR     | [02-XDR-EDR-Endpoint-AnalyzingDailyDetections.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-Detection-Query-Repository/02-XDR-EDR-Endpoint-AnalyzingDailyDetections.md) |
| XDR     | [03-XDR-AnalyzingAllDetection-With-MITRE-ATTCK.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-Detection-Query-Repository/03-XDR-AnalyzingAllDetections-With-MITRE-ATTCK.md)

### Detection & Attack Techniques   
| Type, Tag   | Detection & Attack Techniques         |
|:------------|:--------------------------------------|
| BEC, OAuth | Threat actors misuse OAuth applications to automate financially driven attacks, December 12, 2023 <br> 1. [OAuth application interacting with Azure workloads](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231212-MSSecurityBlog-OAuthApplications-OAuthApptoAzureWorkloads.md) <br> 2. [Password spray attempts](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231212-MSSecurityBlog-OAuthApplications-PasswordSprayAttempts.md) <br> 3. [Suspicious application creation](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231212-MSSecurityBlog-OAuthApplications-SuspiciousAppCreation.md) <br> 4. [Suspicious email events](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231212-MSSecurityBlog-OAuthApplications-SuspiciousEmailEvents.md) <br> 5. [BEC reconnaissance and OAuth application activity](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231212-MSSecurityBlog-OAuthApplications-BECreconnaissanceOAuthApp.md) |
| AiTM, BEC | 1. [From cookie theft to BEC: Attackers use AiTM phishing sites as entry point to further financial fraud](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20220712-MSSecurityBlog-AiTM-HuntingQueries.md), July 12, 2022 <br> 2. [DEV-1101 enables high-volume AiTM campaigns with open-source phishing kit](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20230313-MSSecurityBlog-AiTM-MicrosoftSentinel-AnalyticsTemplate.md), March 13, 2023 <br> 3. [Identifying Adversary-in-the-Middle (AiTM) Phishing Attacks through 3rd-Party Network Detection](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20231129-MSSentinelBlog-AiTM-HuntingQueries.md), Nov 29, 2023 |
| Ransomware, <br> DART| Defenders beware: A case for post-ransomware investigation, October 18, 2022 <br> 1. [Monitoring Task schedules](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-Taskschedules.md) <br> 2. [Monitoring SSH connection](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-SSHconnection.md) <br> 3. [Possible Impacket (WMI) module usage](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-Impacket.md) <br> 4. [PsExec.exe usage](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-PsExec.md) <br> 5. [WDigest credential harvesting](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-WDigest.md) <br> 6. [Antivirus tampering](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/XDR-SIEM-Detection/XDR-SIEM-AttackTechniques-Query-Repository/20221018-MSSecurityBlog-PostRansomware-AntivirusTampering.md)|

> [!Note]
> The idea behind creating this repository ***(Detection & Attack Techniques)*** stems from the sense of disappointment I've felt over time.
> Despite the continuous sharing of excellent blogs, such as MSTIC and DART, there's a recurring concern that lists covering threat hunting queries, attacker TTPs, and similar aspects tend to fade away and get lost as time progresses.
> Consequently, I've taken the initiative to create this repository as a meticulous effort to serve as a log where one can carefully revisit insights into threat hunting against various attacks, to the extent possible.
> 
> By Kijo Ninja

#### Disclaimer
The views and opinions expressed herein are those of the author and do not necessarily reflect the views of company.
