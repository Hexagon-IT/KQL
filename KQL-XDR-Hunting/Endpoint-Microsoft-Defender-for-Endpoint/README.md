# Endpoint-related KQL queries
Thank you for visiting @LearningKijo KQL repository. 
In this repository, I am excited to share email-based out-of-the-box queries related to ***Microsoft Defender for Endpoint (MDE)*** and ***Microsoft Defender Antivirus (AV)***.

| Product | Feature   | KQL query |
|:--------|:----------|:----------|
| AV      | Detection | [01-AV-Detection-ThreatInsightWithFilenameByDeviceList.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/01-AV-Detection-ThreatInsightWithFilenameByDeviceList.md) |
| AV      | ScanTime  | [02-AV-LastCompletedAVScanTime-For-EachDevice.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/02-AV-LastCompletedAVScanTime-For-EachDevice.md) |
| MDE     | ASR Rules | [01-MDE-ASR-Rules-Detections-Block-Audit.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/01-MDE-ASR-Rules-Detections-Block-Audit.md) |
| MDE     | ASR Rules | [02-MDE-ASR-Rules-VisualizingDetectionWithPieChart.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/02-MDE-ASR-Rules-VisualizingDetectionWithPieChart.md) |
| MDE     | ASR Rules | [03-MDE-ASR-Rules-DetectionAcrossAllDevices.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/03-MDE-ASR-Rules-DetectionAcrossAllDevices.md) |
| MDE     | ASR Rules | [04-MDE-ASR-Rules-CategorizedDetection-Graph.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/04-MDE-ASR-Rules-CategorizedDetection-Graph.md) |
| MDE     | Indicators "Block" | [01-MDE-URL-Indicators-Block.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/01-MDE-URL-Indicators-Block.md) | 
| MDE     | Indicators "Warn"  | [02-MDE-URL-Indicators-Bypass.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/02-MDE-URL-Indicators-Bypass.md) |
| MDE     | Network Protection | [03-MDE-NetworkProtection-Detection.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/03-MDE-NetworkProtection-Detection.md)
| SS      | Defender SmartScreen  | [04-SS-DefenderSmartScreen-Detection.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/04-SS-DefenderSmartScreen-Detection.md)
| MDE     | Web Content Filtering | [05-MDE-WebContentFiltering-Detection.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/05-MDE-WebContentFiltering-Detection.md)
| MDE     | Troubleshooting mode  | [01-MDE-TamperProtection-TSmode-AVver-DeviceList.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/01-MDE-TamperProtection-TSmode-AVver-DeviceList.md) |
| MDE     | Vulnerability Management | [01-MDE-TVM-InstalledSoftware-List-Windows.md](https://github.com/LearningKijo/KQL/blob/main/KQL-XDR-Hunting/Endpoint-Microsoft-Defender-for-Endpoint/MDE-Query-Repository/01-MDE-TVM-InstalledSoftware-List-Windows.md) |



> [!Note]
> - SS : Microsoft Defender SmartScreen
> - AV : Microsoft Defender Antivirus
> - MDE : MicrosoftDefender for Endpoint

#### Disclaimer
The views and opinions expressed herein are those of the author and do not necessarily reflect the views of company.
