name : malware family
description : 
- case1 - Email, Weekly malware detection name list 
- case2 - Email, Weekly malware detection name list with columnchart
table : 
- EmailEvents
- https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-emailevents-table?view=o365-worldwide
query : |
  //Case1 - Email, Weekly malware detection name list 
  EmailEvents
  | where Timestamp > ago(7d)
  | where isnotempty(ThreatNames)
  | extend ThreatName = split(ThreatNames, ",")
  | mv-expand ThreatName
  | summarize ThreatNumber = count() by tostring(ThreatName)
  | sort by ThreatNumber desc 


  //case2 - Email, Weekly malware detection name list with columnchart
  EmailEvents
  | where Timestamp > ago(7d)
  | where isnotempty(ThreatNames)
  | extend ThreatName = split(ThreatNames, ",")
  | mv-expand ThreatName
  | summarize ThreatNumber = count() by tostring(ThreatName)
  | render columnchart 

  