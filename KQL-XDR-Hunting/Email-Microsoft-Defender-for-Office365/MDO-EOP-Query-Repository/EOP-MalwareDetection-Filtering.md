#  EOP Malware Detection filtering
This query displays weekly EOP malware detection.

#### Table name & Description
- [EmailEvents](https://learn.microsoft.com/en-us/microsoft-365/security/defender/advanced-hunting-emailevents-table?view=o365-worldwide) : Microsoft 365 email events, including email delivery and blocking events

```kusto
EmailEvents
| where Timestamp > ago(30d)
| where isnotempty(DetectionMethods)
| extend EOP_detection = parse_json(DetectionMethods)
| where EOP_detection.Malware in 
        (
          @'["File reputation"]',
          @'["Antimalware engine"]',
          @'["URL malicious reputation"]'
        )
| extend SenderFromAddress_IPv4 = strcat(SenderFromAddress, ", ", SenderIPv4)
| project Timestamp, NetworkMessageId, Subject, SenderFromAddress_IPv4, RecipientEmailAddress, DeliveryLocation, EOP_detection.Malware
```

#### Disclaimer
The views and opinions expressed herein are those of the author and do not necessarily reflect the views of company.
